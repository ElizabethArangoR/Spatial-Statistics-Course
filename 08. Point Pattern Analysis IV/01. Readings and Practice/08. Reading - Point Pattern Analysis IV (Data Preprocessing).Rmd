---
title: "Data Preprocessing: Point Pattern Analysis IV"
output: html_notebook
---


# Create a sample dataset to illustrate the insensitivity of quadrats to relative position of events
```{r}
library(tidyverse)
library(spatstat)
```

Create unit-square window:
```{r}
W <- owin(x = c(0, 1), y = c(0, 1))
```

Create a regular set of points:
```{r}
points <- expand.grid(x = seq(from = 0.01, to = 0.09, by = 0.03), y = seq(from = 0.01, to = 0.09, by = 0.03))
```

Generate random locations:
```{r}
x_random_locations <- runif(n = 9, min = 0.01, max= 0.91)
y_random_locations <- runif(n = 9, min = 0.01, max= 0.91)
```

Place regular set of points on random locations:
```{r}
count <- 0
pp1 <- data.frame(x = numeric(length = 81), y = numeric(length = 81))
for(i in 1:9){
  for(j in 1:9){
    count <- count + 1
    pp1$x[count] <- points$x[i] + x_random_locations[j]
    pp1$y[count] <- points$y[i] + y_random_locations[j]
  }
}
```

Convert to `ppp`:
```{r}
pp1 <- as.ppp(X = pp1, W = W)
```

Plot:
```{r}
plot(pp1)
```

Create a regular arrangement of clustered points:
```{r}
count <- 0
pp2 <- data.frame(x = numeric(length = 81), y = numeric(length = 81))
for(i in 1:3){
  for(j in 1:3){
    count <- count + 1
    pp2$x[(9 * (count - 1) + 1):(9 * count)] <- runif(n = 9, min = 0.10 + (i - 1)/3, max = 0.21 + (i - 1)/3)
    pp2$y[(9 * (count - 1) + 1):(9 * count)] <- runif(n = 9, min = 0.10 + (j - 1)/3, max = 0.21 + (j - 1)/3)
  }
}
pp2 <- as.ppp(X = pp2, W = W)
plot(pp2)
```

Create a random distribution of clustered points:
```{r}
x_random_locations <- runif(n = 9, min = 0.01, max= 0.9)
y_random_locations <- runif(n = 9, min = 0.01, max= 0.9)
pp3 <- data.frame(x = numeric(length = 81), y = numeric(length = 81))
for(i in 1:9){
    pp3$x[(9 * i - 8):(9 * i)] <- runif(n = 9, min = 0.00, max = 0.10) + x_random_locations[i]
    pp3$y[(9 * i - 8):(9 * i)] <- runif(n = 9, min = 0.00, max = 0.10) + y_random_locations[i]
}
pp3 <- as.ppp(X = pp3, W = W)
plot(pp3)
```

Generate regular locations:
```{r}
reg_locations <- expand.grid(x = seq(from = 0.15, to = 0.81, by = 0.33), y = seq(from = 0.15, to = 0.81, by = 0.33))
```

Regular-regular:
```{r}
pp4 <- data.frame(x = numeric(length = 81), y = numeric(length = 81))
for(i in 1:9){
    pp4$x[(9 * i - 8):(9 * i)] <- points$x + reg_locations$x[i]
    pp4$y[(9 * i - 8):(9 * i)] <- points$y + reg_locations$y[i]
}
pp4 <- as.ppp(X = pp4, W = W)
plot(pp4)
```

Generate a fully random pattern:
```{r}
pp1 <- data.frame(x = numeric(length = 81), y = numeric(length = 81))
pp1$x <- runif(n = 81, min = 0, max = 1)
pp1$y <- runif(n = 81, min = 0, max = 1)
pp1 <- as.ppp(X = pp1, W = W)
plot(pp1)
```

Save:
```{r}
save(pp1, pp2, pp3, pp4, pp5, file = "Data5.RData")
```

